from pathfinder.PathFinderFactory import PathFinderFactory
from GraphBuilder import GraphBuilder
from Utils.MetricsExtractor import Metrics_Extractor
from pathfinder.Islands import Islands

stations_data = Metrics_Extractor('./_dataset/Islands.graph.stations.csv').metrics
connections_attr, connections = Metrics_Extractor('./_dataset/Islands.graph.connections.csv').metrics

graph = GraphBuilder(stations_data, connections)

islands = Islands(graph)
islands.findIslands()

def test_Islands():
    assert islands.islands == {'1': [['1', '2', '3', '4']], '2': [['5', '6'], ['7', '8', '9']]}
    assert islands.getPathToIsland() == {'1': {'1': {'path': ['1'], 'zones': {'1'}}, '2': {'path': ['1', '2'], 'zones': {'1'}}, '4': {'path': ['1', '4'], 'zones': {'1'}}, '3': {'path': ['1', '3'], 'zones': {'1'}}, '5': {'path': ['1', '5'], 'zones': {'2', '1'}}, '6': {'path': ['1', '5', '6'], 'zones': {'2', '1'}}, '9': {'path': ['1', '4', '9'], 'zones': {'2', '1'}}, '8': {'path': ['1', '4', '9', '8'], 'zones': {'2', '1'}}, '7': {'path': ['1', '4', '9', '7'], 'zones': {'2', '1'}}}, '2': {'2': {'path': ['2'], 'zones': {'1'}}, '1': {'path': ['2', '1'], 'zones': {'1'}}, '4': {'path': ['2', '4'], 'zones': {'1'}}, '3': {'path': ['2', '1', '3'], 'zones': {'1'}}, '5': {'path': ['2', '1', '5'], 'zones': {'2', '1'}}, '6': {'path': ['2', '1', '5', '6'], 'zones': {'2', '1'}}, '9': {'path': ['2', '4', '9'], 'zones': {'2', '1'}}, '8': {'path': ['2', '4', '9', '8'], 'zones': {'2', '1'}}, '7': {'path': ['2', '4', '9', '7'], 'zones': {'2', '1'}}}, '3': {'3': {'path': ['3'], 'zones': {'1'}}, '1': {'path': ['3', '1'], 'zones': {'1'}}, '2': {'path': ['3', '1', '2'], 'zones': {'1'}}, '4': {'path': ['3', '4'], 'zones': {'1'}}, '5': {'path': ['3', '1', '5'], 'zones': {'2', '1'}}, '6': {'path': ['3', '1', '5', '6'], 'zones': {'2', '1'}}, '9': {'path': ['3', '4', '9'], 'zones': {'2', '1'}}, '8': {'path': ['3', '4', '9', '8'], 'zones': {'2', '1'}}, '7': {'path': ['3', '4', '9', '7'], 'zones': {'2', '1'}}}, '4': {'4': {'path': ['4'], 'zones': {'1'}}, '1': {'path': ['4', '1'], 'zones': {'1'}}, '2': {'path': ['4', '2'], 'zones': {'1'}}, '3': {'path': ['4', '3'], 'zones': {'1'}}, '9': {'path': ['4', '9'], 'zones': {'2', '1'}}, '8': {'path': ['4', '9', '8'], 'zones': {'2', '1'}}, '7': {'path': ['4', '9', '7'], 'zones': {'2', '1'}}, '5': {'path': ['4', '1', '5'], 'zones': {'2', '1'}}, '6': {'path': ['4', '1', '5', '6'], 'zones': {'2', '1'}}}, '5': {'5': {'path': ['5'], 'zones': {'2'}}, '1': {'path': ['5', '1'], 'zones': {'2', '1'}}, '6': {'path': ['5', '6'], 'zones': {'2'}}, '2': {'path': ['5', '1', '2'], 'zones': {'2', '1'}}, '4': {'path': ['5', '1', '4'], 'zones': {'2', '1'}}, '3': {'path': ['5', '1', '3'], 'zones': {'2', '1'}}, '9': {'path': ['5', '1', '4', '9'], 'zones': {'2', '1'}}, '8': {'path': ['5', '1', '4', '9', '8'], 'zones': {'2', '1'}}, '7': {'path': ['5', '1', '4', '9', '7'], 'zones': {'2', '1'}}}, '6': {'6': {'path': ['6'], 'zones': {'2'}}, '5': {'path': ['6', '5'], 'zones': {'2'}}, '1': {'path': ['6', '5', '1'], 'zones': {'2', '1'}}, '2': {'path': ['6', '5', '1', '2'], 'zones': {'2', '1'}}, '4': {'path': ['6', '5', '1', '4'], 'zones': {'2', '1'}}, '3': {'path': ['6', '5', '1', '3'], 'zones': {'2', '1'}}, '9': {'path': ['6', '5', '1', '4', '9'], 'zones': {'2', '1'}}, '8': {'path': ['6', '5', '1', '4', '9', '8'], 'zones': {'2', '1'}}, '7': {'path': ['6', '5', '1', '4', '9', '7'], 'zones': {'2', '1'}}}, '7': {'7': {'path': ['7'], 'zones': {'2'}}, '9': {'path': ['7', '9'], 'zones': {'2'}}, '4': {'path': ['7', '9', '4'], 'zones': {'2', '1'}}, '8': {'path': ['7', '9', '8'], 'zones': {'2'}}, '1': {'path': ['7', '9', '4', '1'], 'zones': {'2', '1'}}, '2': {'path': ['7', '9', '4', '2'], 'zones': {'2', '1'}}, '3': {'path': ['7', '9', '4', '3'], 'zones': {'2', '1'}}, '5': {'path': ['7', '9', '4', '1', '5'], 'zones': {'2', '1'}}, '6': {'path': ['7', '9', '4', '1', '5', '6'], 'zones': {'2', '1'}}}, '8': {'8': {'path': ['8'], 'zones': {'2'}}, '9': {'path': ['8', '9'], 'zones': {'2'}}, '4': {'path': ['8', '9', '4'], 'zones': {'2', '1'}}, '7': {'path': ['8', '9', '7'], 'zones': {'2'}}, '1': {'path': ['8', '9', '4', '1'], 'zones': {'2', '1'}}, '2': {'path': ['8', '9', '4', '2'], 'zones': {'2', '1'}}, '3': {'path': ['8', '9', '4', '3'], 'zones': {'2', '1'}}, '5': {'path': ['8', '9', '4', '1', '5'], 'zones': {'2', '1'}}, '6': {'path': ['8', '9', '4', '1', '5', '6'], 'zones': {'2', '1'}}}, '9': {'9': {'path': ['9'], 'zones': {'2'}}, '4': {'path': ['9', '4'], 'zones': {'2', '1'}}, '8': {'path': ['9', '8'], 'zones': {'2'}}, '7': {'path': ['9', '7'], 'zones': {'2'}}, '1': {'path': ['9', '4', '1'], 'zones': {'2', '1'}}, '2': {'path': ['9', '4', '2'], 'zones': {'2', '1'}}, '3': {'path': ['9', '4', '3'], 'zones': {'2', '1'}}, '5': {'path': ['9', '4', '1', '5'], 'zones': {'2', '1'}}, '6': {'path': ['9', '4', '1', '5', '6'], 'zones': {'2', '1'}}}}    
